# HiFi++: Исследование и стриминговое восстановление аудио

## Описание проекта

Данный репозиторий содержит реализацию и исследование нейросетевой архитектуры **HiFi++**, предназначенной для задач **восстановления пропущенных высокочастотных компонент аудиосигнала (Bandwidth Extension)** и **улучшения качества речи (Speech Enhancement)**.

Модель HiFi++ объединяет U-Net-блоки для спектральной и временной обработки, а также включает модули постобработки, что позволяет достигать высокой точности и естественности восстановленного аудио. Помимо оффлайн-обработки, в проекте реализован **стриминговый режим инференса**, имитирующий работу в реальном времени.

## Цели

- Изучить и протестировать существующие архитектуры для BWE и SE.
- Реализовать и адаптировать модель HiFi++ для различных режимов восстановления.
- Исследовать возможность стриминговой обработки аудиосигналов.
- Провести сравнительный анализ моделей и оценить их по метрикам качества и скорости.

## Ключевые технологии

- **HiFi++** (GAN-based vocoder)
- **PyTorch** и **OmegaConf** для модульной разработки
- Обработка **мелспектрограмм**
- Оценка по метрикам: `MOSNet`, `SISDR`, `LSD`, `STOI`, `PESQ`, `COVL` и др.
- Поддержка оффлайн и стримингового инференса

## Архитектура HiFi++

- `SpectralUNet` — восстанавливает спектр в мел-области
- `HiFi-GAN Upsampler` — переводит спектральные признаки в временную волну
- `WaveUNet` — устраняет искажения во временной области
- `SpectralMaskNet` — постобработка спектра (фильтрация и коррекция)

## Режимы восстановления

| Режим | Частота входа | Частота выхода | Описание |
|-------|----------------|----------------|----------|
| BWE1  | до 1 кГц       | до 16 кГц      | Максимально деградированный |
| BWE2  | до 2 кГц       | до 16 кГц      | Умеренное восстановление |
| BWE4  | до 4 кГц       | до 16 кГц      | Минимально деградированный |

## Результаты

| Режим | PESQ | STOI | SISDR | MOSNet |
|-------|------|------|--------|--------|
| BWE1  | 1.83 | 0.74 | 7.83   | 3.85   |
| BWE2  | 2.77 | 0.89 | 12.87  | 3.95   |
| BWE4  | 3.88 | 0.997| 17.49  | 4.13   |

RTF (real-time factor) в стриминговом режиме улучшался с увеличением размера сегмента.

## Стриминговый инференс

- Используется скользящее окно (`window_size`)
- Каждый сегмент проходит через модель отдельно
- Аудио собирается с минимальной задержкой
- Поддерживаются адаптивные сборки с `marg_dict[file_id]`

## Датасеты

- [VCTK092](https://datashare.ed.ac.uk/handle/10283/3443) — высококачественная речь от 109 дикторов
- WAV формат (16 кГц, 16-bit PCM) используется после конвертации из FLAC

## Направления дальнейших исследований

- Проектирование специализированной стриминговой архитектуры
- Комбинация BWE и Speech Enhancement в едином фреймворке
- Устойчивость моделей к шуму и обрывам сигнала
- Снижение вычислительных затрат для мобильных устройств

## Цитирование

Основано на:
- [HiFi++ (ICASSP 2023)](https://doi.org/10.1109/ICASSP49357.2023.10097255)
- [BAE-Net](https://arxiv.org/abs/2312.13722)
- [AERO](https://arxiv.org/abs/2211.12232)
- [BEHM-GAN](https://arxiv.org/abs/2204.06478)
- [iSTFTNet](https://ieeexplore.ieee.org/document/9747395)
